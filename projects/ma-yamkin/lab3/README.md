# Лабораторная работа №3

## Описание задания

Лабораторная работа состояла из двух частей: 
1. Необходимо выполнить классификацию с помощью SVM на эмбеддингах которые были построены в предыдущей лабораторной работе.
2. Необходимо построить матрицу термин-документ и на этих данных необходимо осуществить тематическое моделирование с помощью LDA.

## Использованные технологии и инструменты
- Датасет: Базовый новостной датасет
- Модели: SVC, PCA, LDA.
- Библиотеки: pandas, numpy, sklearn, collections, re, tqdm, nltk, tqdm, pickle, scipy, matplolib, json, os.

## Результаты работы

1. Классификация:
- В результате работы была обучена модель SVC на двух ядрах: RBF и линейное с разным количеством итераций. 
- После этого было сокращено признаковое пространство с помощью PCA. 
2. Тематическое моделирование:
- Сначала было выполнено построение матрицы термин-документ с учетом что каждый термин должен встречатьтся в базе минимум 10 раз.
- После этого на построенной матрице был обучен LDA с разным количеством задаваемых заранее тем.


## Выводы
Итого:
1. Классификация: 
- Лучшие метрики показало линейное ядро, на всех итерациях они были примерно одинаковыми: 5, 10 и 100 итераций. Значения метрик представлены на графике в диркетории ../classfication_results 
- Наилучшее качество показало PCA при полном сохранении данных. Но начиная с 60 процнетов сохранения данных, качество меняется в пределах 90%, поэтому можно обрезать признаковое пространство до размерности 60, качество при этом падает не сильно.
2. Значение метрики perplexity получлось равным около 6000 на 2 темах и 100 итерациях. При этом увеличение количества тем ухудшает метрику. Графики и сохраненные результаты приведены в лиректории lda_results. Время обучения и результаты тестирования показаны представлены в папке lda_results.

## Инструкция по запуску
1. Установить зависимости: `pip install -r requirements.txt`
2. Загрузить датасет: [train.csv](https://raw.githubusercontent.com/mhjabreel/CharCnn_Keras/master/data/ag_news_csv/train.csv) и [test.csv](https://raw.githubusercontent.com/mhjabreel/CharCnn_Keras/master/data/ag_news_csv/test.csv) в папку ../assets/annotated-corpus
3. Запустить скрипт: `python source/classification.py` для классификации.
4. Запустить прошлую лабораторную работу и сохранить аннотированные корпуса в директорию ../assets/annotated-corpus/train относительно текущей.
5. Запустить скрипт: `python source/build_terme_doc_matrix.py` для создания матрицы термин-документ.
6. Запустить скрипт: `python source/theme_modeilng.py` для обучения lda.

