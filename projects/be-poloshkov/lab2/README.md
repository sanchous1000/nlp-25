# Лабораторная работа №2: Векторизация текста

## Описание задания

Целью данной лабораторной работы является изучение методов векторизации текста с использованием нейронных сетей. В рамках работы необходимо:

1. Реализовать метод векторизации текста с использованием модели Word2Vec
2. Обучить модель на обучающей выборке из первой лабораторной работы
3. Продемонстрировать работу модели на примерах семантически близких и далёких слов с использованием косинусного расстояния
4. Провести эксперименты с гиперпараметрами модели
5. Реализовать метод векторизации документов путём усреднения векторов токенов
6. Выполнить векторизацию тестовой выборки и сохранить результаты в формате TSV

## Использованные технологии и инструменты

### Датасет
- **Обучающая выборка**: аннотированный корпус из лабораторной работы №1
- **Тестовая выборка**: аннотированный корпус из лабораторной работы №1
- **Формат данных**: TSV-файлы с триадами (оригинал, стемминг, лемматизация)

### Модели
- **Word2Vec** (Skip-gram архитектура) - модель для получения векторных представлений слов

### Библиотеки
- `gensim` (4.4.0) — обучение модели Word2Vec
- `numpy` — работа с векторами и матрицами
- `scikit-learn` — расчёт косинусного расстояния
- `tqdm` — отображение прогресса выполнения

## Результаты работы

- Была обучена модель Word2Vec на корпусе из первой лабораторной работы
- Реализована векторизация путем усреднения векторов всех токенов документов
- Найдены семантически близкие слова к выбранным (продемонстрировано ниже)
- Выполнены эксперименты с различными наборами гиперпараметров (продемонстрировано ниже)
- Эмбеддинги сохранены в файле TSV формата согласно условию задания


### Эксперименты с наборами гиперпараметров:

| Эксп. | vector_size | window | min_count | epochs | Словарь | Близкие | Область | Разные | Балл |
|-------|-------------|--------|-----------|--------|---------|---------|---------|--------|------|
| **1**     | 50          | 3      | 2         | 15     | 32713   | 0.3265  | 0.4382  | 0.8234 | **0.4968** |
| 2     | 100         | 5      | 2         | 20     | 32713   | 0.3180  | 0.4395  | 0.7871 | 0.4691 |
| 3     | 100         | 7      | 3         | 20     | 22564   | 0.3324  | 0.4618  | 0.7962 | 0.4638 |
| 4     | 150         | 5      | 2         | 25     | 32713   | 0.3112  | 0.4289  | 0.7654 | 0.4542 |


### Демонстрация семантических отношений


#### Пример: слово "company"

| Слово | Категория | Косинусное расстояние |
|-------|-----------|----------------------|
| firm | близкие | 0.1332 |
| industry | область | 0.2680 |
| market | область | 0.2978 |
| corporation | близкие | 0.3081 |
| business | близкие | 0.3116 |
| stock | область | 0.5690 |
| music | разные | 0.6135 |
| weather | разные | 0.7782 |
| football | разные | 0.8181 |

**Средние расстояния:**
- Близкие слова: **0.2510**
- Предметная область: **0.3783**
- Разные слова: **0.7366**

#### Пример: слово "president"

**Средние расстояния:**
- Близкие слова: **0.4139**
- Предметная область: **0.5120**
- Разные слова: **0.8183**

#### Пример: слово "game"

**Средние расстояния:**
- Близкие слова: **0.3996**
- Предметная область: **0.4065**
- Разные слова: **0.8513**


### Поиск семантически близких слов

Примеры слов, найденных моделью как наиболее похожие:

| Исходное слово | Похожие слова (similarity) |
|----------------|---------------------------|
| company | firm (0.87), unit (0.79), provider (0.75) |
| oil | crude (0.89), price (0.79), gas (0.76) |
| year | month (0.87), decade (0.85), week (0.79) |
| market | sector (0.85), industry (0.72), offering (0.72) |

## Выводы

Модель Word2Vec была успешно обучена на корпусе новостных текстов из первой лабораторной работы. Эксперименты продемонстрировали способность улавливать семантические связи между словами.

Также была подтверждена гипотеза по отношению косинусных расстояний между словами с разной характеристикой по отношению к данному: `близкие < область < разные`.


## Инструкция по запуску

### Предварительные требования

- Python 3.8+
- Наличие аннотированного корпуса из лабораторной работы №1 в директории `assets/annotated-corpus/`

### Установка зависимостей

```bash
pip install -r requirements.txt
```

### Запуск

```bash
cd projects/be-poloshkov/lab2/source
python main.py
```
