# Лабораторная работа

## Описание задания

В рамках лабораторной работы была реализована система векторного представления текстов на основе модели Word2Vec. В качестве входных данных используется аннотированный корпус документов, полученный на предыдущем этапе (первая лабораторная работа), где каждому документу соответствует отдельный TSV-файл с результатами токенизации и лемматизации.

Основные этапы работы:

* загрузка и обработка корпуса документов, сгруппированных по классам;
* восстановление структуры предложений из аннотированных файлов;
* обучение модели Word2Vec на предложениях обучающей выборки;
* получение векторных представлений слов и документов;
* анализ семантической близости слов;
* векторизация тестовой выборки и сохранение результатов в формате TSV.

---

## Использованные технологии и инструменты

* **Датасет**: аннотированный текстовый корпус (train / test), подготовленный в первой лабораторной работе; каждый документ представлен отдельным TSV-файлом и сгруппирован по классам (pos / neg).
* **Модель**: Word2Vec.
* **Библиотеки**:

  * Python 3
  * gensim
  * numpy
  * scikit-learn
  * tqdm

Параметры обучения Word2Vec:

* размерность векторного пространства: 100
* размер окна контекста: 5
* минимальная частота слова: 2
* количество эпох обучения: 20

---

## Результаты работы

### Подготовка обучающей выборки

В ходе загрузки обучающего корпуса были получены следующие характеристики:

* количество документов в обучающей выборке: **1000**;
* количество восстановленных предложений: **11142**;
* размер словаря модели Word2Vec: **7551** токен;
* размерность векторного представления слов и документов: **100**.

Каждое предложение представляется списком лемм, восстановленных на основе аннотированных TSV-файлов. Пример предложения из корпуса:

```
['i', 'rented', 'i', 'am', 'curious', 'yellow', 'from', 'my', 'video', 'store', 'because', 'of', 'all', 'the', 'controversy']
```

### Семантическая близость слов

После обучения модели была продемонстрирована семантическая близость слов с использованием косинусного расстояния между их векторами:

* `company` – `football`: 0.5150
* `game` – `match`: 0.5086

Меньшее значение косинусного расстояния соответствует большей семантической близости. В частности, слова `game` и `match` демонстрируют более тесную связь по сравнению с семантически далекими словами.

Также был выполнен поиск ближайших слов для термина `company`:

```
[('extensive', 0.69),
 ('bin', 0.66),
 ('entranced', 0.66),
 ('metaphysical', 0.66),
 ('property', 0.66)]
```
(перевод для неангличан:
```
[("обширный", 0,69),
("бункер", 0,66),
("очарованный", 0,66),
("метафизический", 0,66),
("собственность", 0,66)]
```
)

Это подтверждает, что модель формирует распределённые представления слов на основе контекста их использования в корпусе.

### Векторизация документов

Векторное представление документа формируется в два этапа:

1. предложение представляется как среднее арифметическое векторов входящих в него слов;
2. документ представляется как среднее арифметическое векторов всех предложений документа.

Таким образом, сохраняется информация о структуре текста и сглаживается влияние отдельных токенов.

### Векторизация тестовой выборки

Для тестовой выборки было обработано **500 документов**. Для каждого документа получено векторное представление фиксированной размерности (100), после чего результаты были сохранены в TSV-файл следующего формата:

```
<document_id> <v1> <v2> ... <v100>
```

Полученный файл может быть использован для последующих задач анализа или классификации текстов.

---

## Выводы

В ходе лабораторной работы была успешно реализована система векторного представления текстов на основе Word2Vec. Обучение модели на уровне предложений позволило получить устойчивые и интерпретируемые векторные представления слов и документов.

В результате:

* была корректно обработана структура корпуса документов;
* обучена модель распределённых представлений слов;
* реализована векторизация документов с учетом структуры предложений;
* продемонстрирована семантическая близость слов на основе косинусного расстояния.

Полученные векторные представления могут быть использованы в дальнейших задачах анализа текстов, включая классификацию, кластеризацию и информационный поиск.

---

## Инструкция по запуску

1. Убедиться, что аннотированный корпус данных расположен в директориях:

   ```
   lab1/assets/annotated-corpus/train/
   lab1/assets/annotated-corpus/test/
   ```

   где документы сгруппированы по классам и представлены в формате TSV.
2. Открыть ноутбук `main.ipynb`.
3. Последовательно выполнить все ячейки ноутбука для:

   * загрузки корпуса;
   * обучения модели Word2Vec;
   * анализа семантической близости;
   * векторизации тестовой выборки.
4. Результаты векторизации будут сохранены в директории `output/` в формате TSV.
